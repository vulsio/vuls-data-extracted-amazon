{
	"id": "ALAS-2020-1386",
	"advisories": [
		{
			"content": {
				"id": "ALAS-2020-1386",
				"title": "Amazon Linux AMI 2014.03 - ALAS-2020-1386: important priority package update for squid",
				"description": "Package updates are available for Amazon Linux AMI that fix the following vulnerabilities:\nCVE-2020-11945:\n\tAn issue was discovered in Squid before 5.0.2. A remote attacker can replay a sniffed Digest Authentication nonce to gain access to resources that are otherwise forbidden. This occurs because the attacker can overflow the nonce reference counter (a short integer). Remote code execution may occur if the pooled token credentials are freed (instead of replayed as valid credentials).\n1827563: CVE-2020-11945 squid: improper access restriction upon Digest Authentication nonce replay could lead to remote code execution\n\nCVE-2019-13345:\n\tThe cachemgr.cgi web module of Squid through 4.7 has XSS via the user_name or auth parameter.\n1727744: CVE-2019-13345 squid: XSS via user_name or auth parameter in cachemgr.cgi\n\nCVE-2019-12525:\n\tAn issue was discovered in Squid 3.3.9 through 3.5.28 and 4.x through 4.7. When Squid is configured to use Digest authentication, it parses the header Proxy-Authorization. It searches for certain tokens such as domain, uri, and qop. Squid checks if this token's value starts with a quote and ends with one. If so, it performs a memcpy of its length minus 2. Squid never checks whether the value is just a single quote (which would satisfy its requirements), leading to a memcpy of its length minus 1.\n1730535: CVE-2019-12525 squid: parsing of header Proxy-Authentication leads to memory corruption\n\nCVE-2019-12519:\n\tAn issue was discovered in Squid through 4.7. When handling the tag esi:when when ESI is enabled, Squid calls ESIExpression::Evaluate. This function uses a fixed stack buffer to hold the expression while it's being evaluated. When processing the expression, it could either evaluate the top of the stack, or add a new member to the stack. When adding a new member, there is no check to ensure that the stack won't overflow.\n1827552: CVE-2019-12519 squid: improper check for new member in ESIExpression::Evaluate allows for stack buffer overflow\n",
				"severity": [
					{
						"type": "vendor",
						"source": "linux-security@amazon.com",
						"vendor": "important"
					}
				],
				"references": [
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12519"
					},
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12525"
					},
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13345"
					},
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11945"
					},
					{
						"source": "linux-security@amazon.com",
						"url": "https://alas.aws.amazon.com/ALAS-2020-1386.html"
					}
				]
			},
			"ecosystems": [
				"amazon:1"
			]
		}
	],
	"vulnerabilities": [
		{
			"content": {
				"id": "CVE-2019-12519",
				"references": [
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12519"
					}
				]
			},
			"ecosystems": [
				"amazon:1"
			]
		},
		{
			"content": {
				"id": "CVE-2019-12525",
				"references": [
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12525"
					}
				]
			},
			"ecosystems": [
				"amazon:1"
			]
		},
		{
			"content": {
				"id": "CVE-2019-13345",
				"references": [
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13345"
					}
				]
			},
			"ecosystems": [
				"amazon:1"
			]
		},
		{
			"content": {
				"id": "CVE-2020-11945",
				"references": [
					{
						"source": "linux-security@amazon.com",
						"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11945"
					}
				]
			},
			"ecosystems": [
				"amazon:1"
			]
		}
	],
	"detection": [
		{
			"ecosystem": "amazon:1",
			"criteria": {
				"operator": "OR",
				"criterions": [
					{
						"vulnerable": true,
						"fix_status": {
							"class": "fixed"
						},
						"package": {
							"name": "squid",
							"architectures": [
								"i686"
							],
							"repositories": [
								"amzn-main",
								"amzn-updates"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "7:3.5.20-15.39.amzn1"
								}
							],
							"fixed": [
								"7:3.5.20-15.39.amzn1"
							]
						}
					},
					{
						"vulnerable": true,
						"fix_status": {
							"class": "fixed"
						},
						"package": {
							"name": "squid-debuginfo",
							"architectures": [
								"i686"
							],
							"repositories": [
								"amzn-main",
								"amzn-updates"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "7:3.5.20-15.39.amzn1"
								}
							],
							"fixed": [
								"7:3.5.20-15.39.amzn1"
							]
						}
					},
					{
						"vulnerable": true,
						"fix_status": {
							"class": "fixed"
						},
						"package": {
							"name": "squid-migration-script",
							"architectures": [
								"i686"
							],
							"repositories": [
								"amzn-main",
								"amzn-updates"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "7:3.5.20-15.39.amzn1"
								}
							],
							"fixed": [
								"7:3.5.20-15.39.amzn1"
							]
						}
					}
				]
			}
		}
	],
	"data_source": {
		"id": "amazon",
		"raws": [
			"vuls-data-raw-amazon/1/updates/2020/ALAS-2020-1386.json"
		]
	}
}
