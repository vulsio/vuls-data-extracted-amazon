{
	"id": "ALAS2-2023-2061",
	"advisories": [
		{
			"id": "ALAS2-2023-2061",
			"title": "Amazon Linux 2 2017.12 - ALAS2-2023-2061: medium priority package update for qemu",
			"description": "Package updates are available for Amazon Linux 2 that fix the following vulnerabilities:\nCVE-2022-4144:\n\tAn out-of-bounds read flaw was found in the QXL display device emulation in QEMU. The qxl_phys2virt() function does not check the size of the structure pointed to by the guest physical address, potentially reading past the end of the bar space into adjacent pages. A malicious guest user could use this flaw to crash the QEMU process on the host causing a denial of service condition.\n\nCVE-2021-4207:\n\tA flaw was found in the QXL display device emulation in QEMU. A double fetch of guest controlled values `cursor->header.width` and `cursor->header.height` can lead to the allocation of a small cursor object followed by a subsequent heap-based buffer overflow. A malicious privileged guest user could use this flaw to crash the QEMU process on the host or potentially execute arbitrary code within the context of the QEMU process.\n\nCVE-2021-3930:\n\tAn off-by-one error was found in the SCSI device emulation in QEMU. It could occur while processing MODE SELECT commands in mode_sense_page() if the 'page' argument was set to MODE_PAGE_ALLS (0x3f). A malicious guest could use this flaw to potentially crash QEMU, resulting in a denial of service condition.\n\nCVE-2021-3527:\n\tA flaw was found in the USB redirector device (usb-redir) of QEMU. Small USB packets are combined into a single, large transfer request, to reduce the overhead and improve performance. The combined size of the bulk transfer is used to dynamically allocate a variable length array (VLA) on the stack without proper validation. Since the total size is not bounded, a malicious guest could use this flaw to influence the array length and cause the QEMU process to perform an excessive allocation on the stack, resulting in a denial of service.\n\nCVE-2021-3392:\n\tA use-after-free flaw was found in the MegaRAID emulator of QEMU. This issue occurs while processing SCSI I/O requests in the case of an error mptsas_free_request() that does not dequeue the request object 'req' from a pending requests queue. This flaw allows a privileged guest user to crash the QEMU process on the host, resulting in a denial of service. Versions between 2.10.0 and 5.2.0 are potentially affected.\n\nCVE-2021-20196:\n\tA NULL pointer dereference flaw was found in the floppy disk emulator of QEMU. This issue occurs while processing read/write ioport commands if the selected floppy drive is not initialized with a block device. This flaw allows a privileged guest user to crash the QEMU process on the host, resulting in a denial of service. The highest threat from this vulnerability is to system availability.\n",
			"severity": [
				{
					"type": "vendor",
					"source": "linux-security@amazon.com",
					"vendor": "medium"
				}
			],
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "https://alas.aws.amazon.com/AL2/ALAS-2023-2061.html"
				},
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20196"
				},
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3392"
				},
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3527"
				},
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3930"
				},
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4207"
				},
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4144"
				}
			]
		}
	],
	"vulnerabilities": [
		{
			"id": "CVE-2021-20196",
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20196"
				}
			]
		},
		{
			"id": "CVE-2021-3392",
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3392"
				}
			]
		},
		{
			"id": "CVE-2021-3527",
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3527"
				}
			]
		},
		{
			"id": "CVE-2021-3930",
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3930"
				}
			]
		},
		{
			"id": "CVE-2021-4207",
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4207"
				}
			]
		},
		{
			"id": "CVE-2022-4144",
			"references": [
				{
					"source": "linux-security@amazon.com",
					"url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4144"
				}
			]
		}
	],
	"detection": [
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "ivshmem-tools",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-block-curl",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-block-iscsi",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-ui-curses",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-kvm",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-kvm-core",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-common",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-block-ssh",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-user",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-img",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-block-dmg",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-audio-sdl",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-user-binfmt",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-system-aarch64-core",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-system-x86",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-debuginfo",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-audio-alsa",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-user-static",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-system-aarch64",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-guest-agent",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-audio-oss",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-ui-gtk",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-system-x86-core",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-block-nfs",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-block-rbd",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-audio-pa",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		},
		{
			"ecosystem": "amazon:2",
			"vulnerable": true,
			"package": {
				"name": "qemu-ui-sdl",
				"repositories": [
					"amzn2-core"
				],
				"architectures": [
					"aarch64"
				]
			},
			"affected": {
				"type": "rpm",
				"range": [
					{
						"lt": "10:3.1.0-8.amzn2.0.10"
					}
				],
				"fixed": [
					"10:3.1.0-8.amzn2.0.10"
				]
			}
		}
	],
	"data_source": "amazon"
}
